<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tecno Arena - Comunidad Gaming</title>
    <meta name="description" content="Tecno Arena - La comunidad de gaming más vibrante y competitiva. Ligas, eventos y clubes exclusivos.">
    <meta name="keywords" content="gaming, ligas, tekken, smash bros, torneos, comunidad gaming">
    <meta name="author" content="Tecno Arena">
    <link rel="stylesheet" href="styles.css">
    <!-- Icono de Font Awesome para iconos como el ojo de contraseña, configuración, etc. -->
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
</head>
<body>
    <!-- Overlay y Diálogo de Confirmación (Oculto por defecto) -->
    <div id="confirm-overlay" class="modal-overlay" style="display: none;">
        <div class="confirm-dialog">
            <h3 id="confirm-title">Confirmar Acción</h3>
            <p id="confirm-message">¿Estás seguro de que quieres realizar esta acción?</p>
            <div class="dialog-actions">
                <button class="btn btn-secondary" onclick="hideConfirmDialog()">Cancelar</button>
                <button class="btn btn-primary" id="confirm-action-button">Aceptar</button>
            </div>
        </div>
    </div>

    <!-- Overlay y Modal de Alerta (Oculto por defecto) -->
    <div id="alert-overlay" class="modal-overlay" style="display: none;">
        <div class="alert-dialog">
            <h3 id="alert-title">Alerta</h3>
            <p id="alert-message">Mensaje de la Alerta.</p>
            <button class="btn btn-primary" onclick="hideAlert()">Cerrar</button>
        </div>
    </div>

    <!-- Header Principal -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <h1><a href="#" onclick="showTab('welcome')" aria-label="Tecno Arena - Ir a inicio">Tecno Arena</a></h1>
                </div>
                <nav>
                    <ul>
                        <li><a href="#" onclick="showTab('welcome')" aria-current="page">Inicio</a></li>
                        
                        <!-- Dropdown Club Tecno Arena -->
                        <li class="dropdown">
                            <a href="#" tabindex="0" aria-haspopup="true">Club Tecno Arena</a>
                            <div class="dropdown-content">
                                <a href="#" onclick="showTab('club-info')">Información</a>
                            </div>
                        </li>

                        <!-- Dropdown Liga Tecno Arena (Información y Ranking) -->
                        <li class="dropdown">
                            <a href="#" tabindex="0" aria-haspopup="true">Liga Tecno Arena</a>
                            <div class="dropdown-content">
                                <a href="#" onclick="showTab('liga-info')">Información</a>
                                <a href="#" onclick="showTab('ranking-divisions'); showDivision('tekken', 'diamante');">Ranking de Divisiones</a>
                            </div>
                        </li>
                    </ul>
                </nav>

                <!-- 1. Interfaz Deslogueada (Visible por defecto) -->
                <div id="auth-unlogged-actions" class="auth-actions" style="display: flex;">
                    <button class="btn btn-login" onclick="toggleLoginForm(true)">Login</button>
                    <button class="btn btn-register" onclick="showTab('register')">Registrarse</button>
                </div>

                <!-- Formulario de Login en Header (Inicialmente oculto, se muestra al hacer click en Login) -->
                <div id="header-login-form-wrapper" class="header-login-form" style="display: none;">
                    <input type="text" id="login-username" placeholder="Usuario/Correo" aria-label="Usuario o Correo" required>
                    <input type="password" id="login-password" placeholder="Contraseña" aria-label="Contraseña" required>
                    <button class="btn btn-primary" onclick="login()">Entrar</button>
                    <button class="btn btn-close" onclick="toggleLoginForm(false)">
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <!-- 2. Interfaz Logueada (Oculta por defecto, visible tras el login) -->
                <div id="profile-actions" class="auth-actions" style="display: none;">
                    <span id="user-display-name" class="user-name"></span>
                    
                    <!-- Botón de Administrador (Solo visible para Administradores) -->
                    <button id="admin-button" class="btn btn-admin" onclick="showTab('admin-panel')" style="display: none;">
                        Admin
                    </button>
                    
                    <!-- Botón de Perfil -->
                    <button class="btn btn-profile" onclick="showTab('profile')">
                        Perfil
                    </button>
                    
                    <!-- Botón de Configuración/Solicitudes (Nueva función) -->
                    <button class="btn btn-config" onclick="showTab('requests')">
                        <i class="fas fa-cog"></i> Config
                    </button>
                    
                    <!-- Botón de Logout -->
                    <button class="btn btn-logout" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Contenido Principal -->
    <main>
        <div class="container">
            <!-- ----------------------------------------------------------- -->
            <!-- SECCIONES DE CONTENIDO GENERAL -->
            <!-- ----------------------------------------------------------- -->
            
            <!-- 1. Bienvenida (Inicialmente activa) -->
            <section id="welcome" class="welcome-section main-content-section active">
                <div class="content-box">
                    <h2>Bienvenido a Tecno Arena</h2>
                    <p>Tu punto de encuentro para la comunidad gaming más competitiva. Explora nuestras ligas, clubes y eventos exclusivos. ¡Regístrate y comienza tu leyenda!</p>
                    <div class="welcome-features">
                        <div class="feature-item">
                            <h3>Ligas Competitivas</h3>
                            <p>Participa en nuestras ligas de Tekken y Super Smash Bros Ultimate con un sistema de divisiones transparente.</p>
                            <a href="#" onclick="showTab('liga-info')" class="btn btn-primary">Ver Ligas</a>
                        </div>
                        <div class="feature-item">
                            <h3>Club Exclusivo</h3>
                            <p>Obtén beneficios exclusivos, acceso a salas privadas y descuentos al unirte a nuestro Club.</p>
                            <a href="#" onclick="showTab('club-info')" class="btn btn-secondary">Unirse al Club</a>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 2. Información del Club Tecno Arena -->
            <section id="club-info" class="info-section main-content-section">
                <div class="content-box">
                    <h2>Club Tecno Arena - Información</h2>
                    <p>El Club Tecno Arena ofrece una experiencia premium a nuestros miembros. ¡Aquí tienes los beneficios!</p>
                    
                    <div class="benefits-grid">
                        <div class="benefit-card">
                            <h4>Acceso Prioritario</h4>
                            <p>Entra a los eventos y salas de juego antes que nadie.</p>
                        </div>
                        <div class="benefit-card">
                            <h4>Descuentos</h4>
                            <p>20% de descuento en la inscripción a todas las ligas y torneos.</p>
                        </div>
                        <div class="benefit-card">
                            <h4>Salas VIP</h4>
                            <p>Acceso a nuestras salas privadas para entrenamientos exclusivos y reuniones.</p>
                        </div>
                    </div>
                    
                    <div class="action-prompt">
                        <p>¿Interesado en formar parte? Inicia sesión para enviar tu solicitud.</p>
                        <button class="btn btn-primary" onclick="showTab('requests')" id="club-request-prompt" style="display: none;">Enviar Solicitud de Membresía</button>
                        <button class="btn btn-primary" onclick="toggleLoginForm(true)" id="club-login-prompt">Login</button>
                    </div>
                </div>
            </section>
            
            <!-- 3. Información de la Liga Tecno Arena -->
            <section id="liga-info" class="info-section main-content-section">
                <div class="content-box">
                    <h2>Liga Tecno Arena - Información</h2>
                    <p>Nuestras ligas competitivas están diseñadas para todos los niveles de habilidad, desde principiantes hasta profesionales. Compite en un sistema de divisiones (Bronce, Plata, Oro, Diamante) y asciende de rango.</p>
                    
                    <h3>Juegos Oficiales</h3>
                    <p>Actualmente ofrecemos ligas para:</p>
                    <ul>
                        <li><strong>Tekken 8:</strong> Lucha por el top de la división Diamante.</li>
                        <li><strong>Super Smash Bros Ultimate:</strong> Demuestra tu habilidad en el escenario.</li>
                    </ul>
                    
                    <div class="action-prompt">
                        <p>¿Listo para competir? Inicia sesión para solicitar tu ingreso a una liga.</p>
                        <button class="btn btn-primary" onclick="showTab('requests')" id="league-request-prompt" style="display: none;">Solicitar Ingreso a Liga</button>
                        <button class="btn btn-primary" onclick="toggleLoginForm(true)" id="league-login-prompt">Login</button>
                    </div>
                </div>
            </section>

            <!-- 4. Ranking de Divisiones -->
            <section id="ranking-divisions" class="main-content-section">
                <div class="content-box">
                    <h2>Liga Tecno Arena - Ranking de Divisiones</h2>
                    
                    <!-- Tabs para seleccionar el juego -->
                    <div class="tabs game-tabs">
                        <button id="tab-tekken" class="btn btn-tab active" onclick="showGameRanking('tekken')">Tekken</button>
                        <button id="tab-smash" class="btn btn-tab" onclick="showGameRanking('smash')">Smash Bros</button>
                    </div>

                    <!-- Contenedor para el ranking de Tekken -->
                    <div id="tekken-ranking" class="ranking-game-container">
                        <h3>Ranking Tekken 8</h3>
                        <!-- Tabs para Divisiones -->
                        <div id="tekken-division-tabs" class="tabs division-tabs">
                            <button class="btn btn-tab active" onclick="showDivision('tekken', 'diamante')">Diamante</button>
                            <button class="btn btn-tab" onclick="showDivision('tekken', 'oro')">Oro</button>
                            <button class="btn btn-tab" onclick="showDivision('tekken', 'plata')">Plata</button>
                            <button class="btn btn-tab" onclick="showDivision('tekken', 'bronce')">Bronce</button>
                        </div>
                        <!-- Filtro y búsqueda -->
                        <div class="ranking-controls">
                            <input type="text" id="ranking-search-tekken" placeholder="Buscar por usuario..." oninput="RankingsModule.updateSearchTerm('tekken', this.value)">
                        </div>
                        <!-- Contenedor de la tabla de ranking (Renderizado por JS) -->
                        <div id="tekken-ranking-content">
                            <!-- Ranking table here -->
                        </div>
                    </div>

                    <!-- Contenedor para el ranking de Smash Bros (Inicialmente oculto) -->
                    <div id="smash-ranking" class="ranking-game-container" style="display: none;">
                        <h3>Ranking Super Smash Bros Ultimate</h3>
                        <!-- Tabs para Divisiones -->
                        <div id="smash-division-tabs" class="tabs division-tabs">
                            <button class="btn btn-tab active" onclick="showDivision('smash', 'diamante')">Diamante</button>
                            <button class="btn btn-tab" onclick="showDivision('smash', 'oro')">Oro</button>
                            <button class="btn btn-tab" onclick="showDivision('smash', 'plata')">Plata</button>
                            <button class="btn btn-tab" onclick="showDivision('smash', 'bronce')">Bronce</button>
                        </div>
                        <!-- Filtro y búsqueda -->
                        <div class="ranking-controls">
                            <input type="text" id="ranking-search-smash" placeholder="Buscar por usuario..." oninput="RankingsModule.updateSearchTerm('smash', this.value)">
                        </div>
                        <!-- Contenedor de la tabla de ranking (Renderizado por JS) -->
                        <div id="smash-ranking-content">
                            <!-- Ranking table here -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- 5. Formulario de Registro -->
            <section id="register" class="form-container main-content-section">
                <div class="content-box">
                    <h2>Registro de Usuario</h2>
                    <form id="register-form" onsubmit="event.preventDefault(); registerUser();">
                        <p class="form-instruction">Ingresa tus datos para unirte a la comunidad.</p>
                        
                        <!-- Nombre y Apellido -->
                        <div class="form-group">
                            <label for="reg-fullname">Nombre y Apellido:</label>
                            <input type="text" id="reg-fullname" name="fullname" required aria-describedby="reg-fullname-error">
                            <div class="error-message" id="reg-fullname-error" role="alert"></div>
                        </div>
                        
                        <!-- Teléfono -->
                        <div class="form-group">
                            <label for="reg-phone">Teléfono:</label>
                            <input type="tel" id="reg-phone" name="phone" required aria-describedby="reg-phone-error">
                            <div class="error-message" id="reg-phone-error" role="alert"></div>
                        </div>
                        
                        <!-- Nombre de usuario (Nick) -->
                        <div class="form-group">
                            <label for="reg-username">Nombre de usuario (Nick):</label>
                            <input type="text" id="reg-username" name="username" required aria-describedby="reg-username-error">
                            <div class="error-message" id="reg-username-error" role="alert"></div>
                        </div>
                        
                        <!-- Correo electrónico -->
                        <div class="form-group">
                            <label for="reg-email">Correo electrónico:</label>
                            <input type="email" id="reg-email" name="email" required aria-describedby="reg-email-error">
                            <div class="error-message" id="reg-email-error" role="alert"></div>
                        </div>
                        
                        <!-- Contraseña -->
                        <div class="form-group">
                            <label for="reg-password">Contraseña:</label>
                            <div class="password-wrapper">
                                <input type="password" id="reg-password" name="password" required aria-describedby="reg-password-error">
                                <span class="password-toggle" onclick="togglePasswordVisibility('reg-password', this)">
                                    <i class="fas fa-eye-slash"></i>
                                </span>
                            </div>
                            <div class="error-message" id="reg-password-error" role="alert"></div>
                        </div>

                        <!-- Confirmar Contraseña -->
                        <div class="form-group">
                            <label for="reg-confirm-password">Confirmar Contraseña:</label>
                            <div class="password-wrapper">
                                <input type="password" id="reg-confirm-password" name="confirm_password" required aria-describedby="reg-confirm-password-error">
                                <span class="password-toggle" onclick="togglePasswordVisibility('reg-confirm-password', this)">
                                    <i class="fas fa-eye-slash"></i>
                                </span>
                            </div>
                            <div class="error-message" id="reg-confirm-password-error" role="alert"></div>
                        </div>
                        
                        <!-- Edad -->
                        <div class="form-group">
                            <label for="reg-age">Edad:</label>
                            <input type="number" id="reg-age" name="age" required min="13" max="120" aria-describedby="reg-age-error">
                            <div class="error-message" id="reg-age-error" role="alert"></div>
                        </div>
                        
                        <!-- Sexo -->
                        <div class="form-group">
                            <label for="reg-gender">Sexo:</label>
                            <select id="reg-gender" name="gender" required aria-describedby="reg-gender-error">
                                <option value="" disabled selected>Selecciona tu sexo</option>
                                <option value="male">Masculino</option>
                                <option value="female">Femenino</option>
                                <option value="other">Otro</option>
                                <option value="not-say">Prefiero no decir</option>
                            </select>
                            <div class="error-message" id="reg-gender-error" role="alert"></div>
                        </div>
                        
                        <!-- Botón de Registro -->
                        <button type="submit" class="btn btn-primary">Registrarse</button>
                    </form>
                </div>
            </section>

            <!-- 6. Página de Perfil de Usuario (Acceso: Usuario Logueado) -->
            <section id="profile" class="info-section main-content-section">
                <div class="content-box">
                    <h2>Mi Perfil</h2>
                    <div id="profile-details">
                        <!-- Detalles del perfil (Renderizado por JS) -->
                        <div class="profile-card">
                            <img id="profile-avatar" src="https://placehold.co/100x100/3e0d4a/ffffff?text=TA" alt="Avatar de usuario">
                            <h3 id="profile-name">Cargando Nombre...</h3>
                            <p id="profile-nick">@Cargando Nick...</p>
                        </div>
                        <div class="profile-info-grid">
                            <p><strong>Correo:</strong> <span id="profile-email"></span></p>
                            <p><strong>Teléfono:</strong> <span id="profile-phone"></span></p>
                            <p><strong>Edad:</strong> <span id="profile-age"></span></p>
                            <p><strong>Sexo:</strong> <span id="profile-gender"></span></p>
                            <p><strong>Miembro del Club:</strong> <span id="profile-is-member">No</span></p>
                            <p><strong>Rol:</strong> <span id="profile-role">Usuario Normal</span></p>
                        </div>
                    </div>
                    <p class="profile-tip">Toda la información es confidencial. Contacta a un administrador para realizar cambios.</p>
                </div>
            </section>

            <!-- 7. Página de Solicitudes (Acceso: Usuario Logueado) -->
            <section id="requests" class="info-section main-content-section">
                <div class="content-box">
                    <h2>Solicitudes y Configuración</h2>
                    <p class="form-instruction">Desde aquí puedes solicitar el ingreso a la Membresía del Club o a una Liga Competitiva.</p>

                    <div class="request-container">
                        <!-- Solicitud de Membresía del Club -->
                        <div class="request-card" id="club-request-card">
                            <h3>Solicitud de Membresía del Club</h3>
                            <p>Únete al Club Tecno Arena para obtener acceso a beneficios exclusivos.</p>
                            <button class="btn btn-primary" onclick="submitClubRequest()" id="submit-club-request-btn">Solicitar Membresía</button>
                            <p id="club-request-status" class="request-status"></p>
                        </div>
                        
                        <!-- Solicitud de Ingreso a Liga -->
                        <div class="request-card" id="league-request-card">
                            <h3>Solicitud de Ingreso a Liga</h3>
                            <p>Elige el juego para el que deseas inscribirte en nuestra liga competitiva.</p>
                            <select id="league-game-select">
                                <option value="" disabled selected>Selecciona un Juego</option>
                                <option value="tekken">Tekken 8</option>
                                <option value="smash">Super Smash Bros Ultimate</option>
                            </select>
                            <button class="btn btn-primary" onclick="submitLeagueRequest()" id="submit-league-request-btn">Solicitar Ingreso a Liga</button>
                            <p id="league-request-status" class="request-status"></p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 8. Panel de Administración (Acceso: Administrador) -->
            <section id="admin-panel" class="info-section main-content-section">
                <div class="content-box">
                    <h2>Panel de Administración</h2>
                    <p class="form-instruction">Gestiona usuarios, rankings y solicitudes pendientes.</p>

                    <!-- Tabs de Administración -->
                    <div class="tabs admin-tabs">
                        <button class="btn btn-tab active" onclick="showAdminTab('ranking-management')">Gestión de Ranking</button>
                        <button class="btn btn-tab" onclick="showAdminTab('request-review')">Revisión de Solicitudes</button>
                        <button class="btn btn-tab" onclick="showAdminTab('user-management')">Gestión de Usuarios</button>
                        <button class="btn btn-tab" onclick="showAdminTab('data-tools')">Herramientas de Datos</button>
                    </div>

                    <!-- 8a. Gestión de Ranking -->
                    <div id="ranking-management" class="admin-tab-content">
                        <h3>Actualizar Puntuación de Usuario</h3>
                        <form onsubmit="event.preventDefault(); updateRankingFromAdminPanel();" class="admin-form">
                            <div class="form-group-inline">
                                <label for="admin-ranking-user">Usuario:</label>
                                <select id="admin-ranking-user" required></select>
                            </div>
                            <div class="form-group-inline">
                                <label for="admin-ranking-game">Juego:</label>
                                <select id="admin-ranking-game" required>
                                    <option value="tekken">Tekken 8</option>
                                    <option value="smash">Smash Bros</option>
                                </select>
                            </div>
                            <div class="form-group-inline">
                                <label for="admin-ranking-division">Nueva División:</label>
                                <select id="admin-ranking-division" required>
                                    <option value="diamante">Diamante</option>
                                    <option value="oro">Oro</option>
                                    <option value="plata">Plata</option>
                                    <option value="bronce">Bronce</option>
                                </select>
                            </div>
                            <div class="form-group-inline">
                                <label for="admin-ranking-score">Nueva Puntuación:</label>
                                <input type="number" id="admin-ranking-score" value="1000" min="0" required>
                            </div>
                            <button type="submit" class="btn btn-primary">Actualizar Ranking</button>
                        </form>
                    </div>

                    <!-- 8b. Revisión de Solicitudes -->
                    <div id="request-review" class="admin-tab-content" style="display: none;">
                        <h3>Solicitudes Pendientes</h3>
                        <div id="pending-requests-container">
                            <!-- Solicitudes (Renderizado por JS) -->
                        </div>
                    </div>
                    
                    <!-- 8c. Gestión de Usuarios -->
                    <div id="user-management" class="admin-tab-content" style="display: none;">
                        <h3>Conceder Permisos de Admin</h3>
                        <form onsubmit="event.preventDefault(); toggleAdminStatus();" class="admin-form">
                            <div class="form-group-inline">
                                <label for="admin-user-select">Usuario:</label>
                                <select id="admin-user-select" required></select>
                            </div>
                            <div class="form-group-inline">
                                <label for="admin-status-action">Acción:</label>
                                <select id="admin-status-action" required>
                                    <option value="grant">Conceder Admin</option>
                                    <option value="revoke">Revocar Admin</option>
                                </select>
                            </div>
                            <button type="submit" class="btn btn-primary">Aplicar Permiso</button>
                        </form>

                        <h3 class="mt-4">Conceder Membresía de Club</h3>
                        <form onsubmit="event.preventDefault(); grantClubMembership();" class="admin-form">
                            <div class="form-group-inline">
                                <label for="member-user-select">Usuario:</label>
                                <select id="member-user-select" required></select>
                            </div>
                            <button type="submit" class="btn btn-primary">Conceder Membresía</button>
                        </form>
                    </div>
                    
                    <!-- 8d. Herramientas de Datos -->
                    <div id="data-tools" class="admin-tab-content" style="display: none;">
                        <h3>Herramientas de Mantenimiento</h3>
                        <button class="btn btn-warning" onclick="confirmAction('resetData()', 'Restablecer Datos', 'Esto eliminará todos los usuarios, solicitudes y rankings (excepto el usuario Admin inicial) y cargará datos de ejemplo. Esta acción no se puede deshacer.')">
                            Restablecer Datos (Limpiar y Cargar Ejemplos)
                        </button>
                    </div>

                </div>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                
                <div class="footer-section contact-info">
                    <h3>Contacto</h3>
                    <p><strong>Instagram:</strong> @tecnoarena.pzo</p>
                    <p><strong>Teléfono:</strong> +58 424-9033619</p>
                    <p><strong>Correo:</strong> Tecnoarenasoporte01@gmail.com</p>
                </div>
                
                <div class="footer-section quick-links-section">
                    <h3>Enlaces Rápidos</h3>
                    <div class="quick-links"> 
                        <a href="#" onclick="showTab('welcome')">Inicio</a>
                        <a href="#" onclick="showTab('club-info')">Club Tecno Arena</a>
                        <a href="#" onclick="showTab('liga-info')">Liga Tecno Arena</a>
                        <a href="#" onclick="showTab('ranking-divisions')">Ranking de Divisiones</a>
                        <a href="#" onclick="showTab('register')">Registrarse</a>
                    </div>
                </div>
            </div>

            <div class="footer-separator"></div>
            
            <div class="footer-bottom">
                <p>&copy; 2024 Tecno Arena. Todos los derechos reservados. | Desarrollado con ❤️</p>
            </div>
        </div>
    </footer>

    <!-- Script de la aplicación -->
    <script src="app.js"></script>
</body>
</html>
